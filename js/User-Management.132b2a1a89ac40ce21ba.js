(self.webpackChunkiam=self.webpackChunkiam||[]).push([[562],{8994:(e,s,t)=>{"use strict";t.d(s,{A:()=>o});var n=t(4848),a=(t(1680),t(316)),r=t(4450),i=t(7334);const o=()=>(0,n.jsxs)("div",{className:"disabledDiv",children:[(0,n.jsx)(i.Ay,{className:"lockIcon"}),(0,n.jsx)(a.h,{headingLevel:"h2",size:"xl",className:"pf-u-mt-lg",children:"This page is temporarily disabled or unavailable at this time"}),(0,n.jsx)(r.E,{className:"pf-u-mt-lg",children:"Please check again at a another time or reach out to Red Hat customer service for additional support"})]})},2489:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>K});var n=t(4848),a=t(1680),r=t.n(a),i=t(4209),o=t(7546),d=t(5322),c=t(7565),l=t(7261),u=t(5402),h=t(1900),m=t(199),g=t(7192),j=t(3807),x=t(8382),p=t(5924),f=t(2565),b=t(9966),k=t(7993),C=t(9536),y=t(3873),T=t(5556),v=t.n(T);const S=({triggerEditUser:e,triggerAddUser:s})=>{const t=(0,a.useContext)(J),[r,i]=(0,a.useState)([]),[o,d]=(0,a.useState)({}),[c,T]=(0,a.useState)("10"),[v,S]=(0,a.useState)("0"),[A,N]=(0,a.useState)(20);(0,a.useEffect)((()=>{(()=>{let e=t.accountAPI+"/"+t.accountID+"/users?";e+=new URLSearchParams({firstResultIndex:v,maxResults:c}),fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.userToken}}).then((e=>e.json())).then((e=>{i(e.body);const s={};for(let t=0;t<e.body.length;t++){const n={status:e.body[t].user.status,username:e.body[t].user.username,checked:!1};s[e.body[t].user.id]=n}d(s)}))})()}),[v]);const U=(e,s,t)=>{T(String(t))},_=()=>{let e;const s=Object.keys(o);for(let t=0;t<s.length;t++)if(o[s[t]].checked){e=s[t];break}e&&fetch(t.accountAPI+"/"+t.accountID+"/users/"+e+"/status",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.userToken},body:JSON.stringify({status:"disabled"})}).then((e=>e.json())).then((()=>{window.location.reload()}))},I=()=>{let s;const n=Object.keys(o);for(let e=0;e<n.length;e++)if(o[n[e]].checked){s=n[e];break}s&&fetch(t.accountAPI+"/"+t.accountID+"/users/"+s,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.userToken}}).then((e=>e.json())).then((s=>{e(s.body)}))},w=()=>{S(v+c)},P=()=>{const e=Number(v)-Number(c);S(String(e))};return(0,n.jsx)("div",{children:(0,n.jsx)((()=>r.length>0?(0,n.jsxs)("div",{children:[(0,n.jsx)(x.M,{id:"userListToolbar",children:(0,n.jsxs)(p.P,{children:[(0,n.jsx)(f.T,{children:(0,n.jsx)(b.D,{"aria-label":"Search user list"})}),(0,n.jsx)(f.T,{children:(0,n.jsx)(k.$n,{onClick:()=>{s()},variant:"primary",children:"Add User"})}),(0,n.jsx)(f.T,{children:(0,n.jsx)(k.$n,{onClick:I,variant:"primary",children:"Edit User"})}),(0,n.jsx)(f.T,{children:(0,n.jsx)(k.$n,{onClick:_,variant:"link",children:"Disable User"})})]})}),(0,n.jsxs)(l.X,{"aria-label":"Sortable table",children:[(0,n.jsx)(u.d,{children:(0,n.jsxs)(h.Tr,{children:[(0,n.jsx)(m.Th,{}),(0,n.jsx)(m.Th,{children:"Name"}),(0,n.jsx)(m.Th,{modifier:"wrap",children:"Email"}),(0,n.jsx)(m.Th,{modifier:"wrap",info:{tooltip:"More information "},children:"LastName"}),(0,n.jsx)(m.Th,{modifier:"wrap",children:"First Name"}),(0,n.jsx)(m.Th,{modifier:"wrap",children:"Status"})]})}),(0,n.jsx)(g.N,{children:r.map((e=>(0,n.jsxs)(h.Tr,{children:[(0,n.jsx)(j.Td,{children:(0,n.jsx)(y.S,{onChange:(s,t)=>((e,s)=>{const t=o[e];t.checked=!!s,d({...o,[e]:t})})(e.user.id,t),isChecked:o[e.user.id].checked,id:e.user.id+"-check"})}),(0,n.jsx)(j.Td,{children:e.user.username}),(0,n.jsx)(j.Td,{children:e.user.email}),(0,n.jsx)(j.Td,{children:e.user.lastName}),(0,n.jsx)(j.Td,{children:e.user.firstName}),(0,n.jsx)(j.Td,{children:e.user.status})]},e.user.username)))})]}),(0,n.jsx)(C.d,{widgetId:"bottom-pagination",itemCount:A,perPage:Number(c),variant:C.A.bottom,onPerPageSelect:U,onNextClick:w,onPreviousClick:P,page:Number(v)})]}):(0,n.jsx)("div",{children:"spinner ...."})),{})})};S.propTypes={triggerEditUser:v().func,triggerAddUser:v().func};const A=S;var N=t(1855),U=t(2457),_=t(7632);const I=({defaultText:e,idValue:s,items:t,onSelect:a})=>{const[i,o]=r().useState(!1),[d,c]=r().useState(e);return(0,n.jsx)(N.m,{onSelect:()=>{o(!1),document.getElementById(s).focus()},toggle:(0,n.jsx)(U.C,{id:s,onToggle:(e,s)=>(e=>{o(e)})(s),children:d}),isOpen:i,dropdownItems:t.map((e=>(0,n.jsx)(_.t,{onClick:()=>{a(e),c(e)},children:e},e)))})};I.propTypes={defaultText:v().string,idValue:v().string,items:v().array,onSelect:v().func};const w=I;var P=t(9915),E=t(3133),z=t(3543),D=t(915),L=t(4398),R=t(983),O=t(6780),M=t(3285),B=t(5600);const F=({editingUser:e,triggerReturn:s})=>{const t=(0,a.useContext)(J),[r,i]=(0,a.useState)([]),[o,c]=(0,a.useState)(!1),[l,u]=(0,a.useState)({salutation:"",firstName:"",lastName:"",email:"",address:{city:"",country:"",county:"",state:"",streets:[],zipCode:""},permissions:[""],phone:"",roles:[],username:"",id:"",status:""});(0,a.useEffect)((()=>{e&&(c(!0),u(e))}),[]);const[h,m]=(0,a.useState)({portal_manage_subscriptions:!1,portal_download:!1,portal_system_management:!1,portal_manage_cases:!1,admin:!1}),g=(e,s)=>{const t=[...l.address.streets];t[s]=e;const n={...l.address};n.streets=t,u({...l,address:n})},j=(e,s)=>{const t={...l.address};t[e]=s,u({...l,address:t})},x=e=>{const s={...h};s[e]=!h[e],m(s);const t=Object.keys(s),n=[];for(let e=0;e<t.length;e++)if(!0===s[t[e]])if("admin"===t[e]){const e=["organization_administrator"];u({...l,roles:e})}else n.push(t[e]),u({...l,permissions:n})};return(0,n.jsx)("div",{children:(0,n.jsxs)(E.l,{children:[(0,n.jsx)("div",{children:(0,n.jsx)(z._,{isLiveRegion:!0,children:r})}),(0,n.jsxs)(D.Z,{children:[(0,n.jsx)(L.a,{children:"Name"}),(0,n.jsxs)(R.b,{children:[(0,n.jsx)(O.g,{children:(0,n.jsx)(w,{items:["Mr.","Mrs.","Other"],idValue:"greetingDropdown",defaultText:"Greeting",onSelect:(e,s)=>{u({...l,[s]:e})}})}),(0,n.jsx)(O.g,{label:"First Name",children:(0,n.jsx)(M.ks,{id:"firstName",onChange:(e,s)=>{u({...l,firstName:s})},value:l.firstName})}),(0,n.jsx)(O.g,{label:"Last Name",children:(0,n.jsx)(M.ks,{id:"lastName",onChange:(e,s)=>{u({...l,lastName:s})},value:l.lastName})})]})]}),(0,n.jsxs)(D.Z,{children:[(0,n.jsx)(L.a,{children:"Address"}),(0,n.jsxs)(R.b,{children:[(0,n.jsx)(O.g,{label:"Email",children:(0,n.jsx)(M.ks,{id:"email",onChange:(e,s)=>{u({...l,email:s})},value:l.email})}),(0,n.jsx)(O.g,{label:"Address Line 1",children:(0,n.jsx)(M.ks,{id:"address1",onChange:(e,s)=>{g(s,0)},value:l.address.streets[0]})}),(0,n.jsx)(O.g,{label:"Address Line 2",children:(0,n.jsx)(M.ks,{id:"address2",onChange:(e,s)=>{g(s,1)},value:l.address.streets[1]})}),(0,n.jsx)(O.g,{label:"Address Line 3",children:(0,n.jsx)(M.ks,{id:"address3",onChange:(e,s)=>{g(s,2)},value:l.address.streets[2]})}),(0,n.jsx)(O.g,{label:"Postal Code",children:(0,n.jsx)(M.ks,{id:"postalcode",onChange:(e,s)=>{j("zipCode",s)},value:l.address.zipCode})}),(0,n.jsx)(O.g,{label:"City",children:(0,n.jsx)(M.ks,{id:"city",onChange:(e,s)=>{j("city",s)},value:l.address.city})}),(0,n.jsx)(O.g,{label:"State",children:(0,n.jsx)(M.ks,{id:"state",onChange:(e,s)=>{j("state",s)},value:l.address.state})}),(0,n.jsx)(O.g,{label:"County",children:(0,n.jsx)(M.ks,{id:"county",onChange:(e,s)=>{j("county",s)},value:l.address.county})}),(0,n.jsx)(O.g,{label:"Country",children:(0,n.jsx)(M.ks,{id:"country",onChange:(e,s)=>{j("country",s)},value:l.address.country})}),(0,n.jsx)(O.g,{label:"Phone Number",children:(0,n.jsx)(M.ks,{id:"phoneNumber",onChange:(e,s)=>{u({...l,phone:s})},value:l.phone})})]})]}),(0,n.jsxs)(D.Z,{children:[(0,n.jsx)(L.a,{children:"Red Hat Login"}),(0,n.jsx)(R.b,{children:(0,n.jsx)(O.g,{children:(0,n.jsx)(M.ks,{id:"login",onChange:(e,s)=>{u({...l,username:s})},value:l.username})})})]}),(0,n.jsxs)(D.Z,{children:[(0,n.jsx)(L.a,{children:"Permissions"}),(0,n.jsx)(R.b,{children:(0,n.jsxs)(O.g,{children:[(0,n.jsx)(y.S,{label:"Manage Support Cases",isChecked:h.portal_manage_cases,onChange:()=>{x("portal_manage_cases")},id:"controlled-check-1",name:"check1"}),(0,n.jsx)(y.S,{label:"Download Software and Updates",isChecked:h.portal_download,onChange:()=>{x("portal_download")},id:"controlled-check-2",name:"check2"}),(0,n.jsx)(y.S,{label:"View/Renew Subscription Information",isChecked:h.portal_system_management,onChange:()=>{x("portal_system_management")},id:"controlled-check-3",name:"check3"}),(0,n.jsx)(y.S,{label:"Manage Your Subscriptions",isChecked:h.portal_manage_subscriptions,onChange:()=>{x("portal_manage_subscriptions")},id:"controlled-check-4",name:"check4"}),(0,n.jsx)(d.c,{id:"adminDivider",component:"div"}),(0,n.jsx)(y.S,{label:"Account Administrator",isChecked:h.admin,onChange:()=>{x("admin")},id:"admin",name:"check5"})]})})]}),(0,n.jsxs)(B.K,{children:[(0,n.jsx)(k.$n,{onClick:()=>{const e={...l};let a;o&&(delete e.id,delete e.username,delete e.status),a=o?t.accountAPI+"/"+t.accountID+"/users/"+l.id:t.accountAPI+"/"+t.accountID+"/users",fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t.userToken},body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{e.status?400===e.status?(i([(0,n.jsx)(P.F,{title:e.title,variant:"danger",timeout:8e3,children:JSON.stringify(e.errors)},e.title)]),document.getElementsByClassName("pf-c-page__main")[0].scrollTop=0):200===e.status?s():(i([(0,n.jsx)(P.F,{title:e.title,variant:"danger",timeout:8e3,children:"Unexpected Result"},"mainAlert")]),document.getElementsByClassName("pf-c-page__main")[0].scrollTop=0):e.body&&s()}))},variant:"primary",children:"Submit"}),(0,n.jsx)(k.$n,{onClick:()=>{s()},variant:"link",children:"Cancel"})]})]})})};F.propTypes={editingUser:v().bool,triggerReturn:v().func};const G=F;var Z=t(881);const J=(0,a.createContext)({accountAPI:"",accountID:"",userToken:""}),$=()=>{const e=(0,Z.A)();let s;s="stage.foo.redhat.com:1337"===window.location.host||"console.stage.redhat.com"===window.location.host?"https://api.access.stage.redhat.com/account/v1/accounts":"https://api.access.redhat.com/account/v1/accounts";const[t,r]=(0,a.useState)({accountAPI:s,accountID:"",userToken:""}),l={accountAPI:s,accountID:"",userToken:""},[u,h]=(0,a.useState)({userList:!0,addUser:!1,editUser:!1}),[m,g]=(0,a.useState)(),j=()=>{h({userList:!1,addUser:!0,editUser:!1})},x=()=>{h({userList:!0,addUser:!1,editUser:!1})},p=e=>{g(e),h({userList:!1,addUser:!1,editUser:!0})};return(0,a.useEffect)((()=>{e.auth.getToken().then((e=>{l.userToken=String(e),fetch(t.accountAPI,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e}}).then((e=>e.json())).then((e=>{const s=e.body[0];l.accountID=s.id,r(l)}))}))}),[]),(0,n.jsxs)("div",{children:[(0,n.jsxs)(i.A,{children:[(0,n.jsx)(o.A,{title:"User Management",className:"pf-v5-u-mb-lg"}),(0,n.jsx)("p",{children:" Manage organization users and privelages"})]}),(0,n.jsx)(d.c,{}),(0,n.jsx)(c.d8,{children:(0,n.jsx)(J.Provider,{value:t,children:(0,n.jsx)((()=>t.accountID&&t.accountID.length>0?u.userList?(0,n.jsx)(A,{triggerAddUser:j,triggerEditUser:p,triggerCancel:x}):u.addUser?(0,n.jsx)(G,{triggerReturn:x,editingUser:void 0}):u.editUser?(0,n.jsx)(G,{triggerReturn:x,editingUser:m}):null:(0,n.jsx)("div",{children:"Loading Spinner..."})),{})})})]})};var V=t(4747),X=t(8994),H=t(1903);const K=()=>{const e=(0,Z.A)();let s=null;const[t,i]=(0,a.useState)({adminUser:!0,renderedPage:(0,n.jsx)($,{})}),o=(0,H.useFlag)("iamconsole.usermanagement.enabled");return(0,a.useEffect)((()=>{e.auth.getToken().then((e=>{s=e,(0,V.X2)(s)&&o&&i({adminUser:!0,renderedPage:(0,n.jsx)($,{})}),o||i({adminUser:!1,renderedPage:(0,n.jsx)(X.A,{})})}))}),[]),(0,n.jsx)(r().Fragment,{children:t.renderedPage})}},4747:(e,s,t)=>{"use strict";function n(e){const s=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/");return JSON.parse(decodeURIComponent(window.atob(s).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join("")))}function a(e){return n(e).is_org_admin}function r(e){return n(e).org_id}function i(e,s,t,n){const a={};a[s]=e,n({...t,...a})}function o(e,s,t){let n=!1;const a={};return Object.keys(s).forEach((t=>{const r=e&&e[t],i=s[t].inputType,o=function(e,s,t){if(!e)return{status:"error",message:"This field can not be left empty"};let n,a;switch(s){case"GENERAL":a=/^[.@&]?[a-zA-Z0-9 ]+[ !.@&()]?[ a-zA-Z0-9!()]+/.test(e),n={status:a?"default":"error",message:a?"":"This text is invalid please check for uncommonly used characters"};break;case"DOMAIN":a=/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/g.test(e),n={status:a?"default":"error",message:a?"":"This field needs to be a valid URL"};break;default:n={status:"default",message:""}}return n}(r,i);"error"===o.status&&(n=!0),a[t]={inputType:i,status:o.status,message:o.message}})),t(a),n}t.d(s,{Gw:()=>d,I:()=>r,J1:()=>c,SS:()=>o,X2:()=>a,Xr:()=>i});const d=e=>"prod"===e.getEnvironment()?"https://sso.redhat.com/auth/realms/redhat-external/":"https://sso.stage.redhat.com/auth/realms/redhat-external/",c=(e,s)=>d(e)+s},6403:()=>{},1537:()=>{},4895:()=>{},3701:()=>{},9092:()=>{},1036:()=>{},545:()=>{},8497:()=>{},5937:()=>{},5637:()=>{},4332:()=>{},6083:()=>{},8340:()=>{},2405:()=>{},8195:()=>{},1117:()=>{},6752:()=>{}}]);
//# sourceMappingURL=../sourcemaps/User-Management.9571b744c8de644a3025e7fe10112136.js.map