(self.webpackChunkiam=self.webpackChunkiam||[]).push([[600],{8994:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(4848),n=(i(1680),i(316)),s=i(4450),a=i(7334);const o=()=>(0,r.jsxs)("div",{className:"disabledDiv",children:[(0,r.jsx)(a.Ay,{className:"lockIcon"}),(0,r.jsx)(n.h,{headingLevel:"h2",size:"xl",className:"pf-u-mt-lg",children:"This page is temporarily disabled or unavailable at this time"}),(0,r.jsx)(s.E,{className:"pf-u-mt-lg",children:"Please check again at a another time or reach out to Red Hat customer service for additional support"})]})},6341:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>Ke});var r=i(4848),n=i(1680),s=i.n(n),a=i(8072),o=i(7851),l=i(4209),d=i(7546),c=i(4450),u=i(3539),h=i(316),p=i(3133),I=i(6780),m=i(5523),x=i(5556),v=i.n(x);const j=(0,n.createContext)({validations:{CUSTOMER_INFORMATION:{},OIDC_CONFIG:{},SAML_CONFIG:{},IMPORT_FROM_FILE:{},IMPORT_FROM_URL:{},IMPORT_SAML_FROM_FILE:{},IMPORT_SAML_FROM_URL:{},IMPORT_SAML_MANUALLY:{}},setValidations:()=>{}}),S=()=>{const e=(0,n.useContext)(j);if(!e)throw new Error("Validation context not found");return e},f=j,g=({resetNextClicked:e,rootUserChoices:t,updateStatus:i})=>{const{validations:s,setValidations:a}=S();return(0,n.useEffect)((()=>{const e={...s};e.CUSTOMER_INFORMATION={protocol:{inputType:"RADIO",variant:"default",message:""}},a(e)}),[]),(0,r.jsxs)(p.l,{children:[(0,r.jsx)(h.h,{headingLevel:"h2",children:"Customer Information"}),(0,r.jsx)(c.E,{className:"pf-v5-u-color-400 pf-v5-u-font-size-sm",children:"All fields are required"}),(0,r.jsxs)(I.g,{onChange:r=>{(r=>{((e,t,i,r)=>{i(!1),t||(t={}),t.selections||(t.selections={}),t.selections[e.target.name]=e.target.value,t.selections.protocol&&r(t.selections.protocol)})(r,t,e,i)})(r)},role:"radiogroup",fieldId:"authType",label:"Choose identity provider protocol",id:"protocol",children:[(0,r.jsx)(m.m,{content:"This feature is not yet available",position:"left-start",children:(0,r.jsx)(u.s,{isDisabled:!0,name:"protocol",id:"oidc-protocol",label:"OpenID Connect",value:"OIDC_CONFIG"})}),(0,r.jsx)(u.s,{name:"protocol",id:"saml-protocol",label:"SAML 2.0",value:"SAML_CONFIG"})]})]})};g.propTypes={resetNextClicked:v().func,rootUserChoices:v().object};const A=g;var y=i(3285),C=i(9257),L=i(9937),R=i(4747);const M=({resetNextClicked:e,rootUserChoices:t,updateStatus:i})=>{const[s,a]=(0,n.useState)(),o=r=>{e(!1),t.selections[r.target.id]=r.target.value,t.selections.inputMethod&&i(t.selections.inputMethod)},l=e=>{if("default"===e||"error"===e)return e},{validations:d,setValidations:c}=S();return(0,n.useEffect)((()=>{const e={...d};e.OIDC_CONFIG={clientId:{inputType:"GENERAL",variant:"default",message:"The Red Hat client identifier registered within the customer identity provider. Your identity provider generates this client ID when a Red Hat client is added"},clientSecret:{inputType:"GENERAL",variant:"default",message:"Enter the client secret associated with your client identifier  by your identity provider"},inputMethod:{inputType:"RADIO",variant:"default",message:""}},c(e)}),[]),(0,r.jsxs)(p.l,{children:[(0,r.jsxs)(I.g,{label:"Client ID/SP entity ID",onChange:e=>{o(e)},children:[(0,r.jsx)(y.ks,{onChange:(e,t)=>(0,R.Xr)(t,"clientId",s,a),type:"text",id:"clientId"}),(0,r.jsx)(C.E,{children:(0,r.jsx)(L.j,{variant:l(d.OIDC_CONFIG?.clientId?.variant),children:d.OIDC_CONFIG?.clientId?.message})})]}),(0,r.jsxs)(I.g,{label:"Client Secret",onChange:e=>{o(e)},children:[(0,r.jsx)(y.ks,{onChange:(e,t)=>(0,R.Xr)(t,"clientSecret",s,a),type:"text",id:"clientSecret"}),(0,r.jsx)(C.E,{children:(0,r.jsx)(L.j,{variant:l(d.OIDC_CONFIG?.clientSecret?.variant),children:d.OIDC_CONFIG?.clientSecret?.message})})]}),(0,r.jsxs)(I.g,{onChange:e=>{o(e)},label:"Load external IdP metadata from a config file or download it from a url",children:[(0,r.jsx)(u.s,{name:"inputChoice",id:"inputMethod",label:"Import from URL",value:"IMPORT_FROM_URL"}),(0,r.jsx)(u.s,{name:"inputChoice",id:"inputMethod",label:"Import from file",value:"IMPORT_FROM_FILE"}),(0,r.jsx)(C.E,{children:(0,r.jsx)(L.j,{variant:l(d.OIDC_CONFIG?.inputMethod?.variant),children:d.OIDC_CONFIG?.inputMethod?.message})})]})]})};M.propTypes={resetNextClicked:v().func,rootUserChoices:v().object};const O=M,T=({resetNextClicked:e,rootUserChoices:t,updateStatus:i})=>{const{validations:s,setValidations:a}=S();return(0,n.useEffect)((()=>{const e={...s};e.SAML_CONFIG={inputMethod:{inputType:"RADIO",variant:"default",message:""}},a(e)}),[]),(0,r.jsxs)(p.l,{children:[(0,r.jsx)(h.h,{headingLevel:"h2",children:"SAML IdP configuration selection"}),(0,r.jsxs)(I.g,{onChange:r=>{(r=>{e(!1),t.selections[r.target.name]=r.target.value,t.selections.inputMethod&&i(t.selections.inputMethod)})(r)},label:"Load external identity provider metadata",children:[(0,r.jsx)(u.s,{name:"inputMethod",id:"inportFromFile",label:"Import SAML from file",value:"IMPORT_SAML_FROM_FILE"}),(0,r.jsx)(u.s,{name:"inputMethod",id:"inportManually",label:"Import SAML manually",value:"IMPORT_SAML_MANUALLY"})]})]})};T.propTypes={resetNextClicked:v().func,rootUserChoices:v().object,updateStatus:v().func};const _=T;var E=i(3069),F=i(8805),N=i.n(F);const b=({updateStatus:e,rootUserChoices:t})=>{const[i,s]=(0,n.useState)(""),{validations:a,setValidations:o}=S();return(0,r.jsxs)(p.l,{children:[(0,r.jsx)(h.h,{headingLevel:"h2",children:"Import from file"}),(0,r.jsx)(I.g,{label:"File upload",isRequired:!0,children:(0,r.jsx)(E.e,{value:i.toString(),id:"text-file-with-edits-allowed",type:"text",onDataChange:(i,r)=>{s(r),N().parseString(r,((i,r)=>{if(i)console.error(i);else if(r){e("FINAL_STEP"),t.selections.configFileData=r;const i={...a};i.IMPORT_FROM_URL={},o(i)}}))},browseButtonText:"Upload"})}),(0,r.jsx)(c.E,{className:"pf-v5-u-color-400 pf-v5-u-font-size-sm",children:"An XML formatted file detailing the configuration of your IdP, minimally including the OpenID Connect Identity provider discovery URL"})]})};b.propTypes={rootUserChoices:v().object,rootValidation:v().object,updateStatus:v().func};const D=b,P=({resetNextClicked:e,rootUserChoices:t})=>{const[i,s]=(0,n.useState)({importURL:{inputType:"DOMAIN",status:"default",message:""}});return(0,r.jsxs)(p.l,{children:[(0,r.jsx)(h.h,{headingLevel:"h2",children:"Import from URL"}),(0,r.jsxs)(I.g,{label:"URL",children:[(0,r.jsx)(y.ks,{type:"text",id:"importURL",onChange:i=>{(i=>{e(!1),t.current.selections[i.currentTarget.id]=i.currentTarget.value})(i)}}),(0,r.jsx)(C.E,{children:(0,r.jsx)(L.j,{children:"import metadata from a remote identity provider discovery descriptor"})})]})]})};P.propTypes={resetNextClicked:v().func,rootUserChoices:v().object,nextClicked:v().func};const U=P;var k=i(5886),w=i(1864),G=i(2543),$=i.n(G),z=i(6454);function H(e,...t){if(!e)return"";let i=e.replace(/%s|%d/g,(e=>{const i=t.shift();return String(i)}));return i=i.replace(/{(?:\d+)}/g,((e,i)=>{const r=t[parseInt(i,10)];return void 0!==r?String(r):e})),i}class Y{static OIDC_CONFIG="OIDC_CONFIG";static SAML_CONFIG="SAML_CONFIG";static IMPORT_FROM_FILE="IMPORT_FROM_FILE";static IMPORT_FROM_URL="IMPORT_FROM_URL";static IMPORT_SAML_FROM_FILE="IMPORT_SAML_FROM_FILE";static IMPORT_SAML_FROM_URL="IMPORT_SAML_FROM_URL";static IMPORT_SAML_MANUALLY="IMPORT_SAML_MANUALLY";static FINAL_STEP="FINAL_STEP";static CUSTOMER_INFORMATION="CUSTOMER_INFORMATION"}class q{static IDENTITY_PROVIDER_ENTITY_ID="@_entityID";static BINDING="@_Binding";static LOCATION="@_Location";static KEY_INFO="KeyInfo";static X509_DATA="X509Data";static X509_CERTIFICATE="X509Certificate";static DS_KEY_INFO="ds:KeyInfo";static DS_X509_DATA="ds:X509Data";static DS_X509_CERTIFICATE="ds:X509Certificate";static HTTP_POST_BINDING="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST";static HTTP_REDIRECT_BINDING="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect"}const V="identityProviderEntityId",X="authenticationRequestsUrl",B="x509Certificate",W="serviceProviderIssuer";class K{static INVALID_OR_MISSING_DATA="Invalid or missing data";static INVALID_OR_MISSING_IDPENTITYID="Invalid or missing IdP Entity ID";static INVALID_OR_MISSING_AUTH_REQUEST_URL="Invalid or missing Authentication Request URL";static INVALID_OR_MISSING_CERTIFICATE="Invalid or missing X509 Certificate";static SUCCESS_MSG="loaded successfully";static FILE_SUCCESSFULLY_LOADED="%s "+K.SUCCESS_MSG+" (size: %dK)";static FILE_PARSING_ERROR="Error parsing XML: %s";static INVALID_FILE_TYPE="Invalid file type. Only XML files are allowed.";static MALICIOUS_FILE_DETECTED="Error: Invalid XML document.";static FILE_READ_ERROR="Error reading file";static SAML_XML_REQUIREMENTS="Upload an XML file with your IdP configuration. Max file size allowed is %d K";static FILE_TOO_LARGE="Must be an XML file no larger than %d KB"}const J=(0,n.forwardRef)((({resetNextClicked:e,rootUserChoices:t,maxKBSize:i,updateStatus:s},a)=>{const o=["text/xml"],[l,d]=(0,n.useState)(null),[c,u]=(0,n.useState)(""),[h,p]=(0,n.useState)(""),[m,x]=(0,n.useState)(null),[v,j]=(0,n.useState)(null),[f,g]=(0,n.useState)(!1),[A,y]=(0,n.useState)(!1),[R,M]=(0,n.useState)(!1),{validations:O,setValidations:T}=S();function _(){d(null),u(""),p(""),j(""),x(""),g(!1)}return(0,n.useImperativeHandle)(a,(()=>({getFile:()=>l}))),(0,r.jsxs)(I.g,{fieldId:"xml-file-with-restrictions",children:[(0,r.jsx)(E.e,{id:"xml-file-with-restrictions",type:"text",value:c,filename:h,filenamePlaceholder:"Drag and drop the SAML metadata file or upload one",onFileInputChange:(r,n)=>{if(_(),p(n.name),n){const r=new FileReader;r.onerror=()=>{M(!1),x(K.FILE_READ_ERROR)},r.onload=r=>{const a=r.target?.result;!function(e){return e.includes("<!DOCTYPE")||e.includes("<!ENTITY")||e.includes("SYSTEM")||(e.match(/<!ENTITY/gu)||[]).length>5||e.includes("&")&&!/&[a-zA-Z0-9]+;/u.test(e)}(a)?function(e){return o.includes(e.type)?e.size>1024*i&&(g(!0),!0):(x(K.INVALID_FILE_TYPE),j(null),!0)}(n)||function(i,r){e(!1);try{const e=new z.XMLParser({ignoreAttributes:!1,allowBooleanAttributes:!0,attributeNamePrefix:"@_",parseAttributeValue:!0,ignorePiTags:!0}).parse(i),n=e?.EntityDescriptor?.IDPSSODescriptor?.KeyDescriptor||e["md:EntityDescriptor"]?.["md:IDPSSODescriptor"]?.["md:KeyDescriptor"]||[],a=e.EntityDescriptor?.IDPSSODescriptor?.SingleSignOnService||e["md:EntityDescriptor"]?.["md:IDPSSODescriptor"]?.["md:SingleSignOnService"]||null,o=function(e){const t=e.EntityDescriptor||e["md:EntityDescriptor"];return t?.[q.IDENTITY_PROVIDER_ENTITY_ID]?t[q.IDENTITY_PROVIDER_ENTITY_ID]:null}(e),l=function(e){if(e||Array.isArray(e)){const t=e.find((e=>e[q.BINDING]===q.HTTP_POST_BINDING)),i=e.find((e=>e[q.BINDING]===q.HTTP_REDIRECT_BINDING));if(t?.[q.LOCATION])return t[q.LOCATION];if(i?.[q.LOCATION])return i[q.LOCATION]}return null}(a),c=function(e){const t=new Set;if(e)for(const i of Array.isArray(e)?e:[e]){const e=i?.[q.KEY_INFO]?.[q.X509_DATA],r=i?.[q.DS_KEY_INFO]?.[q.DS_X509_DATA];let n=[];e?n=Array.isArray(e?.[q.X509_CERTIFICATE])?e[q.X509_CERTIFICATE]:[e?.[q.X509_CERTIFICATE]]:r&&(n=Array.isArray(r?.[q.DS_X509_CERTIFICATE])?r[q.DS_X509_CERTIFICATE]:[r?.[q.DS_X509_CERTIFICATE]]);for(const e of n)e&&t.add(e)}return t}(n),u=function(e,t,i){return $().isString(e)&&0!==e.length?$().isString(t)&&0!==t.length?0===i.size?K.INVALID_OR_MISSING_CERTIFICATE:K.SUCCESS_MSG:K.INVALID_OR_MISSING_AUTH_REQUEST_URL:K.INVALID_OR_MISSING_IDPENTITYID}(o,l,c);if(u!==K.SUCCESS_MSG)throw new Error(u);t.selections[V]=o,t.selections[X]=l;const h=c.values().next();t.selections[B]=h.value,t.selections.xmlFileWithRestrictions="selected",s(Y.FINAL_STEP),g(!1),d(r),x(null),j(H(K.FILE_SUCCESSFULLY_LOADED,r.name,(r.size/1024).toFixed(2))),M(!0)}catch(e){M(!1),x(H(K.FILE_PARSING_ERROR,e.message))}}(a,n):(M(!1),x(K.MALICIOUS_FILE_DETECTED))},r.readAsText(n)}},onDataChange:(e,t)=>{u(t)},onReadStarted:(e,t)=>{x(""),j("")},onReadFinished:(e,t)=>{y(!0)},onClearClick:e=>{_(),y(!1)},dropzoneProps:{accept:{"text/xml":[".xml"]},maxSize:1024*i,onDropRejected:()=>{g(!0)}},validated:f?"error":"default",browseButtonText:"Upload",hideDefaultPreview:!0}),(0,r.jsx)(w.e,{children:(0,r.jsxs)(C.E,{children:[(0,r.jsx)(L.j,{variant:f?"error":"default",children:H(f?K.FILE_TOO_LARGE:K.SAML_XML_REQUIREMENTS,i)}),(v||m)&&(0,r.jsx)(L.j,{variant:m?"error":"success",children:m??v})]})}),(0,r.jsx)("div",{className:"xml-highlighter",children:R&&c&&(0,r.jsx)(k.Q,{toggleText:A?"Show less":"Show more",onToggle:(e,t)=>{y(t)},isExpanded:A,children:(0,r.jsx)("div",{className:"highlighter-panel",children:c})})})]})}));J.displayName="SamlMetadataFile",J.propTypes={maxKBSize:v().number.isRequired};const Q=({resetNextClicked:e,rootUserChoices:t,updateStatus:i})=>{const[s,a]=(0,n.useState)(),{validations:o,setValidations:l}=S();(0,n.useEffect)((()=>{a((0,r.jsx)(J,{resetNextClicked:e,rootUserChoices:t,updateStatus:i,maxKBSize:100}));const n={...o};n.IMPORT_SAML_FROM_FILE={serviceProviderIssuer:{inputType:"GENERAL",variant:"default",message:'The Entity ID that will be used to uniquely identify the SAML Service Provider. This might also be referred to as a "client" or a "Service Provider Entity ID"'},xmlFileWithRestrictions:{inputType:"GLOBAL",variant:"default",message:""}},l(n)}),[]);const d=e=>{if("default"===e||"error"===e)return e};return(0,r.jsxs)(p.l,{children:[(0,r.jsx)(h.h,{headingLevel:"h2",children:"Import SAML from file"}),(0,r.jsxs)(I.g,{label:"Service provider issuer",isRequired:!0,onChange:r=>{(r=>{e(!1),t.selections[r.target.id]=r.target.value,t.selections&&i(Y.FINAL_STEP)})(r)},children:[(0,r.jsx)(y.ks,{type:"text",id:W}),(0,r.jsx)(C.E,{children:(0,r.jsx)(L.j,{variant:d(o.IMPORT_SAML_FROM_FILE?.serviceProviderIssuer?.variant),children:o.IMPORT_SAML_FROM_FILE?.serviceProviderIssuer?.message})})]}),(0,r.jsxs)(I.g,{label:"File upload",isRequired:!0,children:[s,(0,r.jsx)(C.E,{children:(0,r.jsx)(L.j,{variant:d(o.IMPORT_SAML_FROM_FILE?.xmlFileWithRestrictions?.variant),children:o.IMPORT_SAML_FROM_FILE?.xmlFileWithRestrictions?.message})})]})]})};Q.propTypes={rootUserChoices:v().object,updateStatus:v().func};const Z=Q,ee=({resetNextClicked:e,rootUserChoices:t})=>{const[i,s]=(0,n.useState)({importURL:{inputType:"DOMAIN",status:"default",message:""}});return(0,r.jsxs)(p.l,{children:[(0,r.jsx)(h.h,{headingLevel:"h2",children:"Import from URL"}),(0,r.jsxs)(I.g,{label:"URL",children:[(0,r.jsx)(y.ks,{type:"text",id:"importURL",onChange:i=>{(i=>{e(!1),t.current.selections[i.currentTarget.id]=i.currentTarget.value})(i)}}),(0,r.jsx)(C.E,{children:(0,r.jsx)(L.j,{children:"import metadata from a remote identity provider discovery descriptor"})})]})]})};ee.propTypes={resetNextClicked:v().func,rootUserChoices:v().object,rootValidation:v().object,nextClicked:v().func,updateStatus:v().func};const te=ee;var ie=i(5843);const re=({updateStatus:e,resetNextClicked:t,rootUserChoices:i})=>{const s=r=>{t(!1),i.selections[r.target.id]=r.target.value,i.selections&&e(Y.FINAL_STEP)},a=e=>{if("default"===e||"error"===e)return e},{validations:o,setValidations:l}=S();return(0,n.useEffect)((()=>{const e={...o};e.IMPORT_SAML_MANUALLY={identityProviderEntityId:{inputType:"DOMAIN",variant:"default",message:"The entityID used to validate the issuer for received SAML assertions."},serviceProviderIssuer:{inputType:"GENERAL",variant:"default",message:'The Entity ID that will be used to uniquely identify the SAML Service Provider. This might also be referred to as a "client" or a "Service Provider Entity ID".'},authenticationRequestsUrl:{inputType:"DOMAIN",variant:"default",message:"The URL that receives SAML authentication requests."},x509Certificate:{inputType:"x509",variant:"default",message:"A PEM certificate that is used to check for signatures. Please be sure to exclude start and end blocks if present."}},l(e)}),[]),(0,r.jsxs)(p.l,{children:[(0,r.jsx)(h.h,{headingLevel:"h2",children:"Configure SAML manually"}),(0,r.jsxs)(I.g,{label:"Identity provider entity id",isRequired:!0,onChange:e=>{s(e)},children:[(0,r.jsx)(y.ks,{type:"text",id:V}),(0,r.jsx)(C.E,{children:(0,r.jsx)(L.j,{variant:a(o.IMPORT_SAML_MANUALLY?.identityProviderEntityId?.variant),children:o.IMPORT_SAML_MANUALLY?.identityProviderEntityId?.message})})]}),(0,r.jsxs)(I.g,{label:"Authentication request url",isRequired:!0,onChange:e=>{s(e)},children:[(0,r.jsx)(y.ks,{type:"text",id:X}),(0,r.jsx)(C.E,{children:(0,r.jsx)(L.j,{variant:a(o.IMPORT_SAML_MANUALLY?.authenticationRequestsUrl?.variant),children:o.IMPORT_SAML_MANUALLY?.authenticationRequestsUrl?.message})})]}),(0,r.jsxs)(I.g,{label:"Service provider issuer",isRequired:!0,onChange:e=>{s(e)},children:[(0,r.jsx)(y.ks,{type:"text",id:W}),(0,r.jsx)(C.E,{children:(0,r.jsx)(L.j,{variant:a(o.IMPORT_SAML_MANUALLY?.serviceProviderIssuer?.variant),children:o.IMPORT_SAML_MANUALLY?.serviceProviderIssuer?.message})})]}),(0,r.jsxs)(I.g,{label:"x509 certificate",isRequired:!0,onChange:e=>{s(e)},children:[(0,r.jsx)(ie.fs,{resizeOrientation:"vertical",type:"text",id:B}),(0,r.jsx)(C.E,{children:(0,r.jsx)(L.j,{variant:a(o.IMPORT_SAML_MANUALLY?.x509Certificate?.variant),children:o.IMPORT_SAML_MANUALLY?.x509Certificate?.message})})]})]})};var ne=i(7993),se=i(6165),ae=i(4461),oe=i(881),le=i(358),de=i(1358);const ce=({accessToken:e})=>{const[t,i]=(0,n.useState)(""),s=(0,oe.A)(),a=e=>(0,R.Gw)(s)+e;return(0,n.useEffect)((()=>{i((0,R.I)(e))}),[]),(0,r.jsxs)(p.l,{children:[(0,r.jsx)(h.h,{headingLevel:"h2",children:"Configure URLs"}),(0,r.jsx)(c.E,{className:"pf-v5-u-color-400 pf-v5-u-font-size-sm",children:"Some identity providers require additional configuration when enabling third-party single sign-on. Please review the following information and verify that these are entered where required in your organization’s identity provider."}),(0,r.jsx)(I.g,{label:"Service provider metadata URL",labelIcon:(0,r.jsx)(ae.A,{triggerAction:"hover",bodyContent:(0,r.jsx)("div",{children:"Service provider metadata used to integrate Red Hat with your identity provider."}),children:(0,r.jsx)(ne.$n,{variant:"plain",type:"button",onClick:e=>e.preventDefault(),className:`customPopover ${le.A.formGroupLabelHelp}`,children:(0,r.jsx)(de.Ay,{})})}),children:(0,r.jsx)(se.Ck,{isReadOnly:!0,clickTip:"copied",children:a(`broker/${t}/endpoint/descriptor`)})}),(0,r.jsx)(I.g,{label:"Redirect URL / Assertion Consumption Service (ACS) URL",labelIcon:(0,r.jsx)(ae.A,{triggerAction:"hover",bodyContent:(0,r.jsx)("div",{children:"The redirect URL to use when configuring your identity provider. This is where your identity provider will redirect users to authenticate to Red Hat."}),children:(0,r.jsx)(ne.$n,{variant:"plain",type:"button",onClick:e=>e.preventDefault(),className:`customPopover ${le.A.formGroupLabelHelp}`,children:(0,r.jsx)(de.Ay,{})})}),children:(0,r.jsx)(se.Ck,{isReadOnly:!0,clickTip:"copied",children:a(`broker/${t}/endpoint`)})})]})};var ue=i(4091),he=i(168),pe=i(9915),Ie=i(7877),me=i(1976),xe=i(9202),ve=i(8472);const je=({oidcData:e})=>{const t=(0,oe.A)(),i=(0,R.Gw)(t);return(0,r.jsxs)(p.l,{children:[(0,r.jsx)(pe.F,{variant:"info",isInline:!0,title:"This page currently shows a read-only version of your configuration.",children:(0,r.jsx)("p",{children:"Forthcoming enhancements will provide the ability to edit."})}),(0,r.jsxs)(h.h,{headingLevel:"h1",children:[e.displayName,e.enabled?(0,r.jsx)(Ie.J,{color:"green",icon:(0,r.jsx)(xe.Ay,{}),className:"pf-v5-u-ml-md",children:"Enabled"}):(0,r.jsx)(Ie.J,{color:"grey",icon:(0,r.jsx)(ve.Ay,{}),className:"pf-v5-u-ml-md",children:"Disabled"})]}),(0,r.jsx)(I.g,{label:"Issuer",fieldId:"oidc-issuer",labelIcon:(0,r.jsx)(ae.A,{triggerAction:"hover",bodyContent:(0,r.jsx)("div",{children:"The issuer is used to validate tokens generated by the identity provider and allows additional security for your organization. This value is optional but recommended."}),children:(0,r.jsx)(ne.$n,{variant:"plain",type:"button",onClick:e=>e.preventDefault(),className:`customPopover ${le.A.formGroupLabelHelp}`,children:(0,r.jsx)(de.Ay,{})})}),children:(0,r.jsx)(y.ks,{isDisabled:!0,type:"text",id:"oidc-issuer",name:"oidc-issuer",value:e.issuerUrl})}),(0,r.jsxs)(I.g,{label:"Client ID",fieldId:"oidc-client-id",labelIcon:(0,r.jsx)(ae.A,{triggerAction:"hover",bodyContent:(0,r.jsx)("div",{children:"The client ID registered with the identity provider."}),children:(0,r.jsx)(ne.$n,{variant:"plain",type:"button",onClick:e=>e.preventDefault(),className:`customPopover ${le.A.formGroupLabelHelp}`,children:(0,r.jsx)(de.Ay,{})})}),children:[(0,r.jsx)(y.ks,{isDisabled:!0,type:"text",id:"oidc-client-id",name:"oidc-client-id",value:e.clientId}),(0,r.jsx)(w.e,{children:(0,r.jsx)(C.E,{children:(0,r.jsx)(L.j,{children:"Spaces and special characters are allowed here."})})})]}),(0,r.jsx)(I.g,{label:"Client Secret",fieldId:"oidc-client-secret",labelIcon:(0,r.jsx)(ae.A,{triggerAction:"hover",bodyContent:(0,r.jsx)("div",{children:"The client secret registered with the identity provider."}),children:(0,r.jsx)(ne.$n,{variant:"plain",type:"button",onClick:e=>e.preventDefault(),className:`customPopover ${le.A.formGroupLabelHelp}`,children:(0,r.jsx)(de.Ay,{})})}),children:(0,r.jsx)(y.ks,{isDisabled:!0,type:"text",id:"oidc-client-secret",name:"oidc-client-secret",value:e.clientSecret})}),(0,r.jsx)(I.g,{label:"Authorization URL",fieldId:"oidc-authorization-url-id",labelIcon:(0,r.jsx)(ae.A,{triggerAction:"hover",bodyContent:(0,r.jsx)("div",{children:"URL that performs authentication of the end-user."}),children:(0,r.jsx)(ne.$n,{variant:"plain",type:"button",onClick:e=>e.preventDefault(),className:`customPopover ${le.A.formGroupLabelHelp}`,children:(0,r.jsx)(de.Ay,{})})}),children:(0,r.jsx)(y.ks,{isDisabled:!0,type:"text",id:"oidc-token-url-id",name:"oidc-token-url-id",value:e.authorizationUrl})}),(0,r.jsx)(I.g,{label:"Token URL",fieldId:"authorization-url",labelIcon:(0,r.jsx)(ae.A,{triggerAction:"hover",bodyContent:(0,r.jsx)("div",{children:"URL where an authorization code can be exchanged for an access token and ID token."}),children:(0,r.jsx)(ne.$n,{variant:"plain",type:"button",onClick:e=>e.preventDefault(),className:`customPopover ${le.A.formGroupLabelHelp}`,children:(0,r.jsx)(de.Ay,{})})}),children:(0,r.jsx)(y.ks,{isDisabled:!0,type:"text",id:"authorization-url",name:"authorization-url",value:e.tokenUrl})}),(0,r.jsx)(h.h,{headingLevel:"h3",children:"URLs required for identity provider configuration"}),(0,r.jsx)(me.n,{children:(0,r.jsx)(c.E,{component:c.Y.p,children:"Use these URLs to assist in completing setup within your identity provider."})}),(0,r.jsx)(I.g,{label:"Service provider metadata URL",fieldId:"metadata-url",labelIcon:(0,r.jsx)(ae.A,{triggerAction:"hover",bodyContent:(0,r.jsx)("div",{children:"Service provider metadata used to integrate Red Hat with your identity provider."}),children:(0,r.jsx)(ne.$n,{variant:"plain",type:"button",onClick:e=>e.preventDefault(),className:`customPopover ${le.A.formGroupLabelHelp}`,children:(0,r.jsx)(de.Ay,{})})}),children:(0,r.jsx)(se.Ck,{type:"text",id:"metadata-url",name:"metadata-url",isReadOnly:!0,children:`${i}.well-known/openid-configuration`})}),(0,r.jsx)(I.g,{label:"Redirect URL / Assertion Consumption Service (ACS) URL",fieldId:"redirect-url",labelIcon:(0,r.jsx)(ae.A,{triggerAction:"hover",bodyContent:(0,r.jsx)("div",{children:"The redirect URL to use when configuring your identity provider. This represents your company’s SSO Portal where users authenticate to Red Hat."}),children:(0,r.jsx)(ne.$n,{variant:"plain",type:"button",onClick:e=>e.preventDefault(),className:`customPopover ${le.A.formGroupLabelHelp}`,children:(0,r.jsx)(de.Ay,{})})}),children:(0,r.jsx)(se.Ck,{type:"text",id:"redirect-url",name:"redirect-url",isReadOnly:!0,children:`${i}broker/${e.idpAlias}/endpoint`})}),(0,r.jsxs)(ue.l,{children:[(0,r.jsx)(ae.A,{triggerAction:"hover","aria-label":"Hoverable popover",headerContent:(0,r.jsx)("div",{children:"Read-Only"}),bodyContent:(0,r.jsx)("div",{children:"This page currently shows a read-only version of your configuration. Forthcoming enhancements will provide the ability to edit."}),footerContent:"",children:(0,r.jsx)(he.a,{children:e.enabled?(0,r.jsx)(ne.$n,{variant:"danger",isDisabled:!0,children:"Disable"}):(0,r.jsx)(ne.$n,{variant:"primary",isDisabled:!0,children:"Test and enable"})})}),(0,r.jsx)(he.a,{children:(0,r.jsx)(ne.$n,{variant:"link",isDanger:!0,isDisabled:!0,children:"Delete identity provider"})})]})]})};var Se=i(8025),fe=i(5507);function ge(e){return(0,R.J1)(e,"apis/organizations/v1/identity-providers")}async function Ae(e,t){try{const i=await e.auth.getToken(),r=ge(e)+`/${t}/status`,n=await fetch(r,{method:"PATCH",referrerPolicy:"no-referrer",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({})});if(!n.ok)throw new Error(`Error: ${n.status} ${n.statusText}`);return n}catch(e){throw console.error("Status update failed:",e),e}}const ye=({idpAlias:e,isOpen:t,onClose:i,recomputeAppState:s})=>{const a=(0,oe.A)(),o=(0,R.Gw)(a),[l,d]=(0,n.useState)((0,r.jsx)(ne.$n,{})),[u,p]=(0,n.useState)(!1),[I,m]=(0,n.useState)("info"),[x,v]=(0,n.useState)(""),[j,S]=(0,n.useState)((0,r.jsx)(c.E,{})),[f,g]=(0,n.useState)(""),A=()=>{d((0,r.jsx)(ne.$n,{})),p(!0),m("info"),v("Identity provider testing"),S((0,r.jsx)(c.E,{children:"Testing will open a pop-up window that will authenticate with your configured identity provider. If you are not currently signed into this identity provider, please do so in the pop-up window. Please be sure that pop-ups are allowed in your browser."})),g("")};(0,n.useEffect)((()=>{A()}),[]);const y=()=>{i(),A()},C=async()=>{await Ae(a,e),s(),y()};return(0,r.jsx)(Se.a,{titleIconVariant:I,title:x,isOpen:t,variant:Se.d.medium,onClose:y,actions:[null!==l.key?l:[(0,r.jsx)(ne.$n,{isDisabled:!u,variant:"primary",onClick:()=>{p(!1),S((0,r.jsx)(c.E,{children:"Please complete identity provider testing in pop-up window"})),window.open((()=>{const t={idp_alias:e},i=encodeURIComponent(JSON.stringify(t));return`${o}protocol/openid-connect/auth?client_id=idp-connectivity-testing-login-client&redirect_uri=${o}&response_mode=query&response_type=code&scope=openid&state=${i}`})(),"RH IdP Integration Testing","width=600,height=600,resizable,scrollbars"),window.addEventListener("message",(e=>{o.includes(e.origin)&&(!0===e.data.success?(d((0,r.jsx)(ne.$n,{variant:"primary",onClick:C,children:"Enable"},"Enable")),m("success"),v("Test successful. Enable for your organization?"),S((0,r.jsx)(c.E,{children:"Enabling will require users on your organization to authenticate through your newly-configured identity provider on their next authentication. If you do not enable this now, you will have to re-test again before being allowed to enable this identity provider."}))):(d((0,r.jsx)(ne.$n,{variant:"primary",onClick:y,children:"Dismiss"},"Dismiss")),m("danger"),v("Test failed"),S((0,r.jsxs)(c.E,{children:["Try looking over some ",(0,r.jsx)(fe.Link,{to:"https://access.redhat.com/articles/7092870",children:"common mistakes"})," and then re-testing. If that doesn’t help, ",(0,r.jsx)(fe.Link,{to:"https://access.redhat.com/support/",children:"contact support"}),"."]})),g(e.data.errorMsg)))}))},children:"Test"},"Test"),(0,r.jsx)(ne.$n,{variant:"link",onClick:y,children:"Cancel"},"cancel")]],children:(0,r.jsxs)(me.n,{children:[(0,r.jsx)(c.E,{children:j}),(0,r.jsx)(h.h,{headingLevel:"h3",hidden:!f,children:"Error:"}),(0,r.jsx)(c.E,{hidden:!f,children:f})]})})};var Ce=i(9923),Le=i(928);const Re=({idpAlias:e,isOpen:t,onClose:i,recomputeAppState:n})=>{const s=(0,oe.A)();return(0,r.jsxs)(Se.a,{titleIconVariant:"warning",title:"Disable identity provider?",isOpen:t,variant:Se.d.small,onClose:i,children:[(0,r.jsx)(Ce.c,{children:"Disabling your identity provider will allow users on your organization to sign-in using their Red Hat credentials"}),(0,r.jsxs)(Le.j,{children:[(0,r.jsx)(ne.$n,{variant:"danger",onClick:()=>(async()=>{await Ae(s,e),n(),i()})(),children:"Disable"}),(0,r.jsx)(ne.$n,{variant:"link",onClick:i,children:"Cancel"})]})]})},Me=({idpAlias:e,isOpen:t,onClose:i,recomputeAppState:n})=>{const s=(0,oe.A)();return(0,r.jsxs)(Se.a,{titleIconVariant:"warning",title:"Delete identity provider?",isOpen:t,variant:Se.d.small,onClose:i,children:[(0,r.jsx)(Ce.c,{children:"You will have to restart the wizard to configure an identity provider."}),(0,r.jsxs)(Le.j,{children:[(0,r.jsx)(ne.$n,{variant:"danger",onClick:()=>(async()=>{await async function(e,t){try{const i=await e.auth.getToken(),r=ge(e)+`/${t}`,n=await fetch(r,{method:"DELETE",referrerPolicy:"no-referrer",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({})});if(!n.ok)throw new Error(`Error: ${n.status} ${n.statusText}`);return n}catch(e){throw console.error("IdP deletion failed:",e),e}}(s,e),n(),i()})(),children:"Delete"}),(0,r.jsx)(ne.$n,{variant:"link",onClick:i,children:"Cancel"})]})]})},Oe=({samlData:e,milestoneTwoEnabled:t,recomputeAppState:i})=>{const s=(0,oe.A)(),a=(0,R.Gw)(s),[o,l]=(0,n.useState)(!1),[d,u]=(0,n.useState)(!1),[m,x]=(0,n.useState)(!1);return(0,r.jsxs)(p.l,{children:[e.enabled&&(0,r.jsx)(pe.F,{variant:"info",isInline:!0,title:"This page currently shows a read-only version of your configuration.",children:(0,r.jsx)("p",{children:"Forthcoming enhancements will provide the ability to edit."})}),(0,r.jsxs)(h.h,{headingLevel:"h1",className:"pf-v5-u-display-flex",children:[e.displayName,e.enabled?(0,r.jsx)(Ie.J,{color:"green",icon:(0,r.jsx)(xe.Ay,{}),className:"pf-v5-u-ml-md",children:"Enabled"}):(0,r.jsx)(Ie.J,{color:"grey",icon:(0,r.jsx)(ve.Ay,{}),className:"pf-v5-u-ml-md",children:"Disabled"})]}),(0,r.jsxs)(I.g,{label:"Identity provider entityID",fieldId:"saml-entity-id",labelIcon:(0,r.jsx)(ae.A,{triggerAction:"hover",bodyContent:(0,r.jsx)("div",{children:"The entityID used to validate the issuer for received SAML assertions."}),children:(0,r.jsx)(ne.$n,{variant:"plain",type:"button",onClick:e=>e.preventDefault(),className:`customPopover ${le.A.formGroupLabelHelp}`,children:(0,r.jsx)(de.Ay,{})})}),children:[(0,r.jsx)(y.ks,{isDisabled:!0,type:"text",id:"saml-entity-id",name:"saml-entity-id",value:e.identityProviderEntityId}),(0,r.jsx)(w.e,{children:(0,r.jsx)(C.E,{children:(0,r.jsx)(L.j,{children:"The entityID attribute is in your SAML metadata configuration"})})})]}),(0,r.jsxs)(I.g,{label:"Single sign-on authentication request URL",fieldId:"saml-authn-request-url",children:[(0,r.jsx)(y.ks,{isDisabled:!0,type:"text",id:"saml-authn-request-url",name:"saml-authn-request-url",value:e.authenticationRequestsUrl}),(0,r.jsx)(w.e,{children:(0,r.jsx)(C.E,{children:(0,r.jsx)(L.j,{children:"The URL that receives SAML authentication requests"})})})]}),(0,r.jsxs)(I.g,{label:"Service provider issuer",fieldId:"saml-provider-issuer",children:[(0,r.jsx)(y.ks,{isDisabled:!0,type:"text",id:"saml-provider-issuer",name:"saml-provider-issuer",value:e.serviceProviderEntityId}),(0,r.jsx)(w.e,{children:(0,r.jsx)(C.E,{children:(0,r.jsx)(L.j,{children:'The issuer that will be used to uniquely identify the SAML Service Provider. This might also be referred to as a "client" or a "Service Provider Entity ID"'})})})]}),(0,r.jsxs)(I.g,{label:"x509 certificate",fieldId:"saml-x509-certificate",labelIcon:(0,r.jsx)(ae.A,{triggerAction:"hover",bodyContent:(0,r.jsx)("div",{children:"A PEM certificate that is used to check for signatures."}),children:(0,r.jsx)(ne.$n,{variant:"plain",type:"button",onClick:e=>e.preventDefault(),className:`customPopover ${le.A.formGroupLabelHelp}`,children:(0,r.jsx)(de.Ay,{})})}),children:[(0,r.jsx)(ie.fs,{resizeOrientation:"vertical",isDisabled:!0,type:"text",id:"saml-authn-request-url",name:"saml-authn-request-url",value:e.x509Certificate}),(0,r.jsx)(w.e,{children:(0,r.jsx)(C.E,{children:(0,r.jsxs)(L.j,{children:["A Base64 encoded certificate must not include the certificate preamble/ending:",(0,r.jsx)("code",{children:"(-----BEGIN/END CERTIFICATE-----)"})]})})})]}),(0,r.jsx)(h.h,{headingLevel:"h3",children:"URLs required for identity provider configuration"}),(0,r.jsx)(me.n,{children:(0,r.jsx)(c.E,{component:c.Y.p,children:"Use these URLs to assist in completing setup within your identity provider."})}),(0,r.jsx)(I.g,{label:"Service provider metadata URL",fieldId:"service-provider-metadata-url",labelIcon:(0,r.jsx)(ae.A,{triggerAction:"hover",bodyContent:(0,r.jsx)("div",{children:"Service provider metadata used to integrate Red Hat with your identity provider."}),children:(0,r.jsx)(ne.$n,{variant:"plain",type:"button",onClick:e=>e.preventDefault(),className:`customPopover ${le.A.formGroupLabelHelp}`,children:(0,r.jsx)(de.Ay,{})})}),children:(0,r.jsx)(se.Ck,{type:"text",id:"service-provider-metadata-url",name:"service-provider-metadata-url",isReadOnly:!0,children:`${a}broker/${e.idpAlias}/endpoint/descriptor`})}),(0,r.jsx)(I.g,{label:"Redirect URL / Assertion Consumption Service (ACS) URL",fieldId:"redirect-url",labelIcon:(0,r.jsx)(ae.A,{triggerAction:"hover",bodyContent:(0,r.jsx)("div",{children:"The redirect URL to use when configuring your identity provider. This is where your identity provider will redirect users to authenticate to Red Hat."}),children:(0,r.jsx)(ne.$n,{variant:"plain",type:"button",onClick:e=>e.preventDefault(),className:`customPopover ${le.A.formGroupLabelHelp}`,children:(0,r.jsx)(de.Ay,{})})}),children:(0,r.jsx)(se.Ck,{type:"text",id:"redirect-url",name:"redirect-url",isReadOnly:!0,children:`${a}broker/${e.idpAlias}/endpoint`})}),!t&&(0,r.jsxs)(ue.l,{children:[(0,r.jsx)(ae.A,{triggerAction:"hover","aria-label":"Hoverable popover",headerContent:(0,r.jsx)("div",{children:"Read-Only"}),bodyContent:(0,r.jsx)("div",{children:"This page currently shows a read-only version of your configuration. Forthcoming enhancements will provide the ability to edit."}),footerContent:"",children:(0,r.jsx)(he.a,{children:(0,r.jsx)(ne.$n,{isDisabled:!0,children:"Save"})})}),(0,r.jsx)(he.a,{children:(0,r.jsx)(ne.$n,{isDisabled:!0,variant:"link",children:"Cancel"})})]}),t&&(0,r.jsxs)(ue.l,{hidden:!t,children:[(0,r.jsx)(he.a,{children:e.enabled?(0,r.jsx)(ne.$n,{variant:"danger",onClick:()=>u(!0),children:"Disable"}):(0,r.jsx)(ne.$n,{onClick:()=>l(!0),children:"Test and enable"})}),(0,r.jsx)(he.a,{children:(0,r.jsx)(ne.$n,{variant:"link",onClick:()=>x(!0),isDanger:!0,children:"Delete identity provider"})}),d&&(0,r.jsx)(Re,{idpAlias:e.idpAlias,isOpen:d,onClose:()=>u(!1),recomputeAppState:i}),o&&(0,r.jsx)(ye,{idpAlias:e.idpAlias,isOpen:o,onClose:()=>l(!1),recomputeAppState:i}),m&&(0,r.jsx)(Me,{idpAlias:e.idpAlias,isOpen:m,onClose:()=>x(!1),recomputeAppState:i})]})]})};var Te=i(915),_e=i(983),Ee=i(932);const Fe=({responseData:e,milestoneTwoFeaturesEnabled:t,recomputeAppState:i})=>{const[a,o]=(0,n.useState)((0,r.jsx)(Ee.y,{}));return(0,n.useEffect)((()=>{"saml-improved"===e.providerId?o((0,r.jsx)(Oe,{samlData:e,milestoneTwoEnabled:t,recomputeAppState:i})):"oidc-improved"===e.providerId&&o((0,r.jsx)(je,{oidcData:e}))}),[e]),(0,r.jsx)(s().Fragment,{children:(0,r.jsx)(Te.Z,{isCompact:!1,isLarge:!0,children:(0,r.jsx)(_e.b,{children:a})})})};var Ne=i(3913);const be=({setupIDP:e,wizardEnabled:t})=>(0,r.jsxs)("div",{className:"notSetupDiv",children:[(0,r.jsx)(Ne.Ay,{className:"cubesIcon"}),(0,r.jsx)(h.h,{headingLevel:"h2",size:"xl",className:"pf-v5-u-mt-lg",children:"No Identity Providers are currently configured"}),(0,r.jsxs)(c.E,{className:"pf-v5-u-mt-md",children:["Your organization has not integrated an identity provider. More information is available ",(0,r.jsx)(ne.$n,{variant:"link",target:"_blank",href:"https://access.redhat.com/announcements/7039300",component:"a",isInline:!0,children:"here"}),"."]}),(0,r.jsx)(ne.$n,{className:t?"pf-v5-u-mt-lg":"hideFeature",variant:"primary",onClick:e,children:"Set up an identity provider"})]});be.propTypes={setupIDP:v().func};const De=be;var Pe=i(4698),Ue=i(4501);const ke=({userChoices:e,setNextTriggered:t,setPreviousTriggered:i,currentState:n})=>{const{goToNextStep:s,goToPrevStep:a}=(0,Pe.CV)(),{validations:o,setValidations:l}=S();return(0,r.jsxs)(Ue.W,{children:[(0,r.jsx)(ne.$n,{variant:"secondary",onClick:()=>{a(),i()},children:"Back"}),(0,r.jsx)(ne.$n,{onClick:()=>{(0,R.Qe)(e,n,o,l)?t(!0):s()},children:"Next"})]})};var we=i(3543);const Ge=({userChoiceData:e,previous:t,currentState:i})=>{const n=(0,oe.A)(),{goToNextStep:a,goToPrevStep:o}=(0,Pe.CV)(),[l,d]=s().useState(!1),[c,u]=s().useState(),{validations:h,setValidations:p}=S(),I=e=>{u((0,r.jsx)(pe.F,{variant:"danger",isInline:!0,isPlain:!0,title:e,timeout:8e3,onTimeout:()=>{u([])}}))};return(0,r.jsxs)(Ue.W,{children:[(0,r.jsx)(ne.$n,{variant:"secondary",onClick:()=>{o(),t()},children:"Back"}),(0,r.jsx)(ne.$n,{onClick:()=>{console.log("Submitting with this data: "+JSON.stringify(e,null,2)),(0,R.Qe)(e.current,i,h,p)?d(!1):(d(!0),async function(e,t){try{const i=await e.auth.getToken(),r=await fetch(ge(e),{method:"POST",referrerPolicy:"no-referrer",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(t)});if(!r.ok)throw new Error(`Error: ${r.status} ${r.statusText}`);return r}catch(e){throw console.error("Create failed:",e),e}}(n,{providerId:"OIDC_CONFIG"===e.current.selections.protocol?"oidc-improved":"saml-improved",identityProviderEntityId:e.current.selections[V],authenticationRequestsUrl:e.current.selections[X],serviceProviderEntityId:e.current.selections[W],x509Certificate:e.current.selections[B]}).then((e=>e.json())).then((e=>{e.error||e.error_description?(console.error("Error Type: "+e.error),console.error("Error Message: "+e.error_description),I("Failed to upload config: "+e.error_description),d(!1)):(d(!1),a())})).catch((e=>{I(e.toString()),console.error("Error: ",e),d(!1)})))},isLoading:l,children:"Next"}),(0,r.jsx)(we._,{isLiveRegion:!0,className:"pf-v5-u-mt-sm",children:c})]})};Ge.propTypes={userChoiceData:v().object};const $e=Ge,ze=()=>(0,r.jsx)(Ue.W,{children:(0,r.jsx)(ne.$n,{onClick:()=>{window.location.reload()},children:"Submit"})});var He=i(7565),Ye=i(1903);const qe=({accessToken:e})=>{const t=(0,oe.A)(),i=(0,n.useRef)({selections:{}}),[s,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)(!1),[I,m]=(0,n.useState)(!0),[x,v]=(0,n.useState)(!0),[j,S]=(0,n.useState)({idpAlias:"",providerId:"",displayName:"",enabled:""}),g=(0,Ye.useFlag)("iamconsole.IDPIntegration.wizardFlowEnabled"),y=()=>{(async function(e){try{const t=await e.auth.getToken(),i=await fetch(ge(e),{method:"GET",referrerPolicy:"no-referrer",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(!i.ok)throw new Error(`Error: ${i.status} ${i.statusText}`);return i}catch(e){throw console.error("Fetch failed:",e),e}})(t).then((e=>204===e.status?{status:""}:e.json())).then((e=>{"oidc-improved"===e.providerId||"saml-improved"===e.providerId?(S(e),m(!1),u(!0)):e.error?(m(!1),u(!1),p(!1)):(m(!1),u(!1),p(!0))})).catch((e=>{console.error("Error: ",e),m(!1)}))};(0,n.useEffect)((()=>{y()}),[]);const[C,L]=(0,n.useState)({CUSTOMER_INFORMATION:{},OIDC_CONFIG:{},SAML_CONFIG:{},IMPORT_FROM_FILE:{},IMPORT_FROM_URL:{},IMPORT_SAML_FROM_FILE:{},IMPORT_SAML_FROM_URL:{},IMPORT_SAML_MANUALLY:{}}),[R,M]=(0,n.useState)({currentState:Y.CUSTOMER_INFORMATION,previousState:""}),[T,E]=(0,n.useState)({hideCustomerInformation:!1,hideOIDC:!0,hideSAML:!0,hideImportFromURL:!0,hideImportFromFile:!0,hideImportManually:!0,hideFinish:!0}),[F,N]=(0,n.useState)(!1),b=e=>{let t;switch(e){case Y.OIDC_CONFIG:t={...T},t.hideOIDC=!1,t.hideSAML=!0,E(t),M({currentState:e,previousState:Y.CUSTOMER_INFORMATION});break;case Y.SAML_CONFIG:t={...T},t.hideSAML=!1,t.hideOIDC=!0,E(t),M({currentState:e,previousState:Y.CUSTOMER_INFORMATION});break;case Y.IMPORT_FROM_FILE:t={...T},t.hideImportFromFile=!1,t.hideImportFromURL=!0,E(t),M({currentState:e,previousState:Y.OIDC_CONFIG});break;case Y.IMPORT_FROM_URL:t={...T},t.hideImportFromFile=!0,t.hideImportFromURL=!1,E(t),M({currentState:e,previousState:Y.OIDC_CONFIG});break;case Y.IMPORT_SAML_FROM_FILE:t={...T},t.hideImportManually=!0,t.hideImportFromFile=!1,E(t),M({currentState:e,previousState:Y.SAML_CONFIG});break;case Y.IMPORT_SAML_MANUALLY:t={...T},t.hideImportManually=!1,t.hideImportFromFile=!0,E(t),M({currentState:e,previousState:Y.SAML_CONFIG});break;case Y.IMPORT_SAML_FROM_URL:t={...T},t.hideImportFromURL=!1,E(t),M({currentState:e,previousState:Y.SAML_CONFIG});break;case Y.FINAL_STEP:t={...T},t.hideFinish=!1,E(t),M({currentState:e,previousState:R.currentState});break;default:E({hideCustomerInformation:!1,hideOIDC:!0,hideSAML:!0,hideImportFromURL:!0,hideImportFromFile:!0,hideImportManually:!0,hideFinish:!0})}},P=e=>{const t=Object.keys(i.current.selections);for(let r=0;r<t.length;r++)e.includes(t[r])||delete i.current.selections[t[r]]},k=()=>{(e=>{switch(e){case Y.OIDC_CONFIG:P(["protocol"]),M({currentState:e,previousState:Y.CUSTOMER_INFORMATION}),E({hideCustomerInformation:!1,hideOIDC:!1,hideSAML:!0,hideImportFromURL:!0,hideImportFromFile:!0,hideImportManually:!0,hideFinish:!0});break;case Y.SAML_CONFIG:P(["protocol"]),M({currentState:e,previousState:Y.CUSTOMER_INFORMATION}),E({hideCustomerInformation:!1,hideOIDC:!0,hideSAML:!1,hideImportFromURL:!0,hideImportFromFile:!0,hideImportManually:!0,hideFinish:!0});break;case Y.IMPORT_FROM_FILE:P(["clientId","clientSecret","inputMethod","protocol"]),M({currentState:e,previousState:Y.OIDC_CONFIG}),E({hideCustomerInformation:!1,hideOIDC:!1,hideSAML:!0,hideImportFromURL:!0,hideImportFromFile:!1,hideImportManually:!0,hideFinish:!0});break;case Y.IMPORT_FROM_URL:P(["clientId","clientSecret","inputMethod","protocol"]),M({currentState:e,previousState:Y.OIDC_CONFIG}),E({hideCustomerInformation:!1,hideOIDC:!1,hideSAML:!0,hideImportFromURL:!1,hideImportFromFile:!0,hideImportManually:!0,hideFinish:!0});break;case Y.IMPORT_SAML_FROM_URL:P(["clientId","clientSecret","inputMethod","protocol"]),M({currentState:e,previousState:Y.SAML_CONFIG}),E({hideCustomerInformation:!1,hideOIDC:!0,hideSAML:!1,hideImportFromURL:!1,hideImportFromFile:!0,hideImportManually:!1,hideFinish:!0});break;case Y.IMPORT_SAML_MANUALLY:P(["clientId","clientSecret","inputMethod","protocol"]),M({currentState:e,previousState:Y.SAML_CONFIG}),E({hideCustomerInformation:!1,hideOIDC:!0,hideSAML:!1,hideImportFromURL:!0,hideImportFromFile:!0,hideImportManually:!1,hideFinish:!0});break;case Y.IMPORT_SAML_FROM_FILE:P(["clientId","clientSecret","inputMethod","protocol"]),M({currentState:e,previousState:Y.SAML_CONFIG}),E({hideCustomerInformation:!1,hideOIDC:!0,hideSAML:!1,hideImportFromURL:!0,hideImportFromFile:!1,hideImportManually:!0,hideFinish:!0});break;default:P([""]),E({hideCustomerInformation:!1,hideOIDC:!0,hideSAML:!0,hideImportFromURL:!0,hideImportFromFile:!0,hideImportManually:!0,hideFinish:!0})}})(R.previousState)};return(0,r.jsxs)("div",{className:"flowPage",children:[(0,r.jsxs)(l.A,{className:"wizardHeader",children:[(0,r.jsx)(d.A,{title:"Identity Provider Integration",className:"pf-v5-u-mb-lg"}),(0,r.jsxs)(me.n,{children:["Manage identity provider integration for your organization."," ",(0,r.jsx)(c.E,{component:c.Y.a})]})]}),(0,r.jsxs)(He.d8,{children:[(0,r.jsx)("div",{className:I?"loadingIcon":"hiddenPage",children:(0,r.jsx)(Ee.y,{})}),(0,r.jsx)("div",{className:!I&&s?"":"hiddenPage",children:(0,r.jsx)(Fe,{responseData:j,milestoneTwoFeaturesEnabled:g,recomputeAppState:y})}),(0,r.jsx)("div",{className:I||s||!x?"hiddenPage":"initPage",children:(0,r.jsx)(De,{setupIDP:()=>{v(!1)},wizardEnabled:g&&h})}),(0,r.jsx)("div",{className:s||x?"hiddenPage":"",children:(0,r.jsx)(f.Provider,{value:{validations:C,setValidations:L},children:(0,r.jsxs)(a.s,{onClose:()=>{},isProgressive:!0,children:[(0,r.jsx)(o.W,{id:"CUSTOMERINFORMATION",name:"Customer information",isHidden:T.hideCustomerInformation,footer:(0,r.jsx)(ke,{userChoices:i.current,setNextTriggered:N,setPreviousTriggered:k,currentState:Y.CUSTOMER_INFORMATION}),children:(0,r.jsx)(A,{resetNextClicked:N,rootUserChoices:i.current,updateStatus:b})}),(0,r.jsx)(o.W,{id:"OIDCCONFIG",name:"OIDC Configuration",isHidden:T.hideOIDC,footer:(0,r.jsx)(ke,{userChoices:i.current,setNextTriggered:N,setPreviousTriggered:k,currentState:"OIDC_CONFIG"}),children:(0,r.jsx)(O,{resetNextClicked:N,rootUserChoices:i.current,updateStatus:b})}),(0,r.jsx)(o.W,{id:"IMPORTFROMFILE",name:"Import config from file",isHidden:!(!T.hideOIDC&&!T.hideImportFromFile),footer:(0,r.jsx)($e,{userChoiceData:i,previous:k,currentState:Y.IMPORT_FROM_FILE}),children:(0,r.jsx)(D,{updateStatus:b,resetNextClicked:N,rootUserChoices:i.current})}),(0,r.jsx)(o.W,{id:"IMPORTFROMURL",name:"Import config from URL",isHidden:!(!T.hideOIDC&&!T.hideImportFromURL),footer:(0,r.jsx)($e,{userChoiceData:i,previous:k,currentState:Y.IMPORT_FROM_URL}),children:(0,r.jsx)(U,{resetNextClicked:N,rootUserChoices:i})}),(0,r.jsx)(o.W,{id:"SAMLCONFIG",name:"SAML configuration",isHidden:T.hideSAML,footer:(0,r.jsx)(ke,{userChoices:i.current,setNextTriggered:N,setPreviousTriggered:k,currentState:"SAML_CONFIG"}),children:(0,r.jsx)(_,{resetNextClicked:N,rootUserChoices:i.current,updateStatus:b})}),(0,r.jsx)(o.W,{name:"Import SAML from file",id:"IMPORTSAMLFROMFILE",isHidden:!(!T.hideSAML&&!T.hideImportFromFile),footer:(0,r.jsx)($e,{userChoiceData:i,previous:k,currentState:Y.IMPORT_SAML_FROM_FILE}),children:(0,r.jsx)(Z,{resetNextClicked:N,rootUserChoices:i.current,updateStatus:b})}),(0,r.jsx)(o.W,{name:"Configure SAML manually",id:"IMPORTSAMLMANUALLY",isHidden:!(!T.hideSAML&&!T.hideImportManually),footer:(0,r.jsx)($e,{userChoiceData:i,previous:k,currentState:Y.IMPORT_SAML_MANUALLY}),children:(0,r.jsx)(re,{updateStatus:b,resetNextClicked:N,rootUserChoices:i.current})}),(0,r.jsx)(o.W,{id:"IMPORTSAMLFROMURL",name:"Import SAML from URL",isHidden:!(!T.hideSAML&&!T.hideImportFromURL),footer:(0,r.jsx)($e,{userChoiceData:i,previous:k,currentState:Y.IMPORT_SAML_FROM_URL}),children:(0,r.jsx)(te,{resetNextClicked:N,rootUserChoices:i})}),(0,r.jsx)(o.W,{id:"FINALSTEP",name:"Configure URLs",isHidden:T.hideFinish,footer:(0,r.jsx)(ze,{}),children:(0,r.jsx)(ce,{accessToken:e})})]})})})]})]})};qe.propTypes={accessToken:v().string};const Ve=qe;var Xe=i(8994),Be=i(7334);const We=()=>(0,r.jsxs)("div",{className:"nonAdminDiv",children:[(0,r.jsx)(Be.Ay,{className:"lockIcon"}),(0,r.jsx)(h.h,{headingLevel:"h2",size:"xl",className:"pf-v5-u-mt-lg",children:"Access permissions needed"}),(0,r.jsxs)(c.E,{className:"pf-v5-u-mt-lg",children:["To access Identity Provider Integration, ask your organization administrator(s) to adjust your permissions, or visit ",(0,r.jsx)(ne.$n,{variant:"link",href:"/iam/my-user-access",target:"_blank",component:"a",isInline:!0,children:"My User Access"})," to learn more about your permissions"]}),(0,r.jsx)(ne.$n,{onClick:()=>{window.location.href="/iam/my-user-access"},className:"pf-v5-u-mt-lg",children:"Return to home page"})]}),Ke=()=>{const e=(0,oe.A)();let t=null;const[i,a]=(0,n.useState)({adminUser:!1,selfServiceIDP:(0,r.jsx)(Xe.A,{})}),o=(0,Ye.useFlag)("iamconsole.IDPIntegration.enabled");return(0,n.useEffect)((()=>{e?.appAction?.("identity-provider-integration"),e.auth.getToken().then((e=>{t=e,(0,R.X2)(t)?(0,R.X2)(t)&&o&&a({adminUser:!0,selfServiceIDP:(0,r.jsx)(Ve,{accessToken:t})}):a({adminUser:!1,selfServiceIDP:(0,r.jsx)(We,{})})}))}),[]),(0,r.jsx)(s().Fragment,{children:i.selfServiceIDP})}},4747:(e,t,i)=>{"use strict";function r(e){const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/");return JSON.parse(decodeURIComponent(window.atob(t).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join("")))}function n(e){return r(e).is_org_admin}function s(e){return r(e).org_id}function a(e,t,i,r){const n={};n[t]=e,r({...i,...n})}function o(e,t,i,r){let n=!1;const s={};return Object.keys(i).forEach((r=>{s[r]={},r===t&&Object.keys(i[t]).forEach((t=>{const a=e&&e.selections[t],o=i[r][t].inputType,l=function(e,t,i){if(!e)return"RADIO"===t?{status:"error",message:"A selection must be made"}:{status:"error",message:"This field can not be left empty"};let r,n;switch(t){case"GENERAL":n=!/[^A-Za-z0-9]/.test(e),r={status:n?"default":"error",message:n?"":"This text is invalid please check for uncommonly used characters or spaces"};break;case"DOMAIN":n=/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/g.test(e),r={status:n?"default":"error",message:n?"":"This field needs to be a valid URL"};break;case"x509":n=/^([A-Za-z0-9+\/=]+)(,[A-Za-z0-9+\/=]+)*$/.test(e),r={status:n?"default":"error",message:n?"":"This is invalid, please check for uncommonly used characters. Be sure to exclude the start and end block"};break;default:r={status:"default",message:""}}return r}(a,o);"default"!==l.status&&(n=!0),s[r][t]={inputType:o,variant:l.status,message:l.message}}))})),r(s),n}i.d(t,{Gw:()=>l,I:()=>s,J1:()=>d,Qe:()=>o,X2:()=>n,Xr:()=>a});const l=e=>"prod"===e.getEnvironment()?"https://sso.redhat.com/auth/realms/redhat-external/":"https://sso.stage.redhat.com/auth/realms/redhat-external/",d=(e,t)=>l(e)+t},6882:()=>{},6403:()=>{},5067:()=>{},1902:()=>{},1662:()=>{},4895:()=>{},7302:()=>{},1036:()=>{},6151:()=>{},1225:()=>{},6078:()=>{},545:()=>{},5937:()=>{},5637:()=>{},1289:()=>{},6752:()=>{},5340:()=>{},9838:()=>{}}]);
//# sourceMappingURL=../sourcemaps/Identity-Provider-Integration.50cb803a81a1c559102ce4da4d76659e.js.map