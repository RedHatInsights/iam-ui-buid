(self.webpackChunkiam=self.webpackChunkiam||[]).push([[562],{14082:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var n=a(21527),r=a.n(n),l=a(22021),s=a(22069),c=a(77334);const o=()=>r().createElement("div",{className:"disabledDiv"},r().createElement(c.Ay,{className:"lockIcon"}),r().createElement(l.h,{headingLevel:"h2",size:"xl",className:"pf-u-mt-lg"},"This page is temporarily disabled or unavailable at this time"),r().createElement(s.E,{className:"pf-u-mt-lg"},"Please check again at a another time or reach out to Red Hat customer service for additional support"))},41404:(e,t,a)=>{"use strict";function n(e){const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),a=JSON.parse(decodeURIComponent(window.atob(t).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join("")));return a&&a.is_org_admin}function r(e,t,a,n){const r={};r[t]=e,n({...a,...r})}function l(e,t,a){let n=!1,r={};return Object.keys(t).forEach((a=>{const l=e&&e[a],s=t[a].inputType,c=function(e,t,a){if(!e)return{status:"error",message:"This field can not be left empty"};let n,r;switch(t){case"GENERAL":r=/^[.@&]?[a-zA-Z0-9 ]+[ !.@&()]?[ a-zA-Z0-9!()]+/.test(e),n={status:r?"default":"error",message:r?"":"This text is invalid please check for uncommonly used characters"};break;case"DOMAIN":r=/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/g.test(e),n={status:r?"default":"error",message:r?"":"This field needs to be a valid URL"};break;default:n={status:"default",message:""}}return n}(l,s);"error"===c.status&&(n=!0),r[a]={inputType:s,status:c.status,message:c.message}})),a(r),n}a.d(t,{SS:()=>l,X2:()=>n,Xr:()=>r})},40325:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>H});var n=a(21527),r=a.n(n),l=a(24209),s=a(16401),c=a(15322),o=a(27565),i=a(7261),u=a(15402),m=a(81900),d=a(22473),g=a(97192),E=a(43807),h=a(68382),p=a(5924),b=a(52565),k=a(58091),f=a(72583),y=a(49536),C=a(83873),T=a(5556),v=a.n(T);const S=({triggerEditUser:e,triggerAddUser:t})=>{const a=(0,n.useContext)(G),[l,s]=(0,n.useState)([]),[c,o]=(0,n.useState)({}),[T,v]=(0,n.useState)("10"),[S,A]=(0,n.useState)("0"),[N,U]=(0,n.useState)(20);(0,n.useEffect)((()=>{(()=>{let e=a.accountAPI+"/"+a.accountID+"/users?";e+=new URLSearchParams({firstResultIndex:S,maxResults:T}),fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.userToken}}).then((e=>e.json())).then((e=>{s(e.body);const t={};for(let a=0;a<e.body.length;a++){const n={status:e.body[a].user.status,username:e.body[a].user.username,checked:!1};t[e.body[a].user.id]=n}o(t)}))})()}),[S]);const _=(e,t,a)=>{v(String(a))},I=()=>{let e;const t=Object.keys(c);for(let a=0;a<t.length;a++)if(c[t[a]].checked){e=t[a];break}e&&fetch(a.accountAPI+"/"+a.accountID+"/users/"+e+"/status",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.userToken},body:JSON.stringify({status:"disabled"})}).then((e=>e.json())).then((()=>{window.location.reload()}))},w=()=>{let t;const n=Object.keys(c);for(let e=0;e<n.length;e++)if(c[n[e]].checked){t=n[e];break}t&&fetch(a.accountAPI+"/"+a.accountID+"/users/"+t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.userToken}}).then((e=>e.json())).then((t=>{e(t.body)}))},P=()=>{A(S+T)},z=()=>{let e=Number(S)-Number(T);A(String(e))};return r().createElement("div",null,r().createElement((()=>l.length>0?r().createElement("div",null,r().createElement(h.M,{id:"userListToolbar"},r().createElement(p.P,null,r().createElement(b.T,null,r().createElement(k.D,{"aria-label":"Search user list"})),r().createElement(b.T,null,r().createElement(f.$n,{onClick:()=>{t()},variant:"primary"},"Add User")),r().createElement(b.T,null,r().createElement(f.$n,{onClick:w,variant:"primary"},"Edit User")),r().createElement(b.T,null,r().createElement(f.$n,{onClick:I,variant:"link"},"Disable User")))),r().createElement(i.X,{"aria-label":"Sortable table"},r().createElement(u.d,null,r().createElement(m.Tr,null,r().createElement(d.Th,null),r().createElement(d.Th,null,"Name"),r().createElement(d.Th,{modifier:"wrap"},"Email"),r().createElement(d.Th,{modifier:"wrap",info:{tooltip:"More information "}},"LastName"),r().createElement(d.Th,{modifier:"wrap"},"First Name"),r().createElement(d.Th,{modifier:"wrap"},"Status"))),r().createElement(g.N,null,l.map((e=>r().createElement(m.Tr,{key:e.user.username},r().createElement(E.Td,null,r().createElement(C.S,{onChange:(t,a)=>((e,t)=>{const a=c[e];a.checked=!!t,o({...c,[e]:a})})(e.user.id,a),isChecked:c[e.user.id].checked,id:e.user.id+"-check"})),r().createElement(E.Td,null,e.user.username),r().createElement(E.Td,null,e.user.email),r().createElement(E.Td,null,e.user.lastName),r().createElement(E.Td,null,e.user.firstName),r().createElement(E.Td,null,e.user.status)))))),r().createElement(y.d,{widgetId:"bottom-pagination",itemCount:N,perPage:Number(T),variant:y.A.bottom,onPerPageSelect:_,onNextClick:P,onPreviousClick:z,page:Number(S)})):r().createElement("div",null,"spinner ....")),null))};S.propTypes={triggerEditUser:v().func,triggerAddUser:v().func};const A=S;var N=a(81855),U=a(72457),_=a(87632);const I=({defaultText:e,idValue:t,items:a,onSelect:n})=>{const[l,s]=r().useState(!1),[c,o]=r().useState(e);return r().createElement(N.m,{onSelect:()=>{s(!1),document.getElementById(t).focus()},toggle:r().createElement(U.C,{id:t,onToggle:(e,t)=>(e=>{s(e)})(t)},c),isOpen:l,dropdownItems:a.map((e=>r().createElement(_.t,{key:e,onClick:()=>{n(e),o(e)}},e)))})};I.propTypes={defaultText:v().string,idValue:v().string,items:v().array,onSelect:v().func};const w=I;var P=a(89915),z=a(73133),D=a(13543),L=a(60915),j=a(14398),R=a(983),O=a(56780),x=a(23285),M=a(35600);const B=({editingUser:e,triggerReturn:t})=>{const a=(0,n.useContext)(G),[l,s]=(0,n.useState)([]),[o,i]=(0,n.useState)(!1),[u,m]=(0,n.useState)({salutation:"",firstName:"",lastName:"",email:"",address:{city:"",country:"",county:"",state:"",streets:[],zipCode:""},permissions:[""],phone:"",roles:[],username:"",id:"",status:""});(0,n.useEffect)((()=>{e&&(i(!0),m(e))}),[]);const[d,g]=(0,n.useState)({portal_manage_subscriptions:!1,portal_download:!1,portal_system_management:!1,portal_manage_cases:!1,admin:!1}),E=(e,t)=>{const a=[...u.address.streets];a[t]=e;const n={...u.address};n.streets=a,m({...u,address:n})},h=(e,t)=>{const a={...u.address};a[e]=t,m({...u,address:a})},p=e=>{const t={...d};t[e]=!d[e],g(t);const a=Object.keys(t),n=[];for(let e=0;e<a.length;e++)if(!0===t[a[e]])if("admin"===a[e]){const e=["organization_administrator"];m({...u,roles:e})}else n.push(a[e]),m({...u,permissions:n})};return r().createElement("div",null,r().createElement(z.l,null,r().createElement("div",null,r().createElement(D._,{isLiveRegion:!0},l)),r().createElement(L.Z,null,r().createElement(j.a,null,"Name"),r().createElement(R.b,null,r().createElement(O.g,null,r().createElement(w,{items:["Mr.","Mrs.","Other"],idValue:"greetingDropdown",defaultText:"Greeting",onSelect:(e,t)=>{m({...u,[t]:e})}})),r().createElement(O.g,{label:"First Name"},r().createElement(x.ks,{id:"firstName",onChange:(e,t)=>{m({...u,firstName:t})},value:u.firstName})),r().createElement(O.g,{label:"Last Name"},r().createElement(x.ks,{id:"lastName",onChange:(e,t)=>{m({...u,lastName:t})},value:u.lastName})))),r().createElement(L.Z,null,r().createElement(j.a,null,"Address"),r().createElement(R.b,null,r().createElement(O.g,{label:"Email"},r().createElement(x.ks,{id:"email",onChange:(e,t)=>{m({...u,email:t})},value:u.email})),r().createElement(O.g,{label:"Address Line 1"},r().createElement(x.ks,{id:"address1",onChange:(e,t)=>{E(t,0)},value:u.address.streets[0]})),r().createElement(O.g,{label:"Address Line 2"},r().createElement(x.ks,{id:"address2",onChange:(e,t)=>{E(t,1)},value:u.address.streets[1]})),r().createElement(O.g,{label:"Address Line 3"},r().createElement(x.ks,{id:"address3",onChange:(e,t)=>{E(t,2)},value:u.address.streets[2]})),r().createElement(O.g,{label:"Postal Code"},r().createElement(x.ks,{id:"postalcode",onChange:(e,t)=>{h("zipCode",t)},value:u.address.zipCode})),r().createElement(O.g,{label:"City"},r().createElement(x.ks,{id:"city",onChange:(e,t)=>{h("city",t)},value:u.address.city})),r().createElement(O.g,{label:"State"},r().createElement(x.ks,{id:"state",onChange:(e,t)=>{h("state",t)},value:u.address.state})),r().createElement(O.g,{label:"County"},r().createElement(x.ks,{id:"county",onChange:(e,t)=>{h("county",t)},value:u.address.county})),r().createElement(O.g,{label:"Country"},r().createElement(x.ks,{id:"country",onChange:(e,t)=>{h("country",t)},value:u.address.country})),r().createElement(O.g,{label:"Phone Number"},r().createElement(x.ks,{id:"phoneNumber",onChange:(e,t)=>{m({...u,phone:t})},value:u.phone})))),r().createElement(L.Z,null,r().createElement(j.a,null,"Red Hat Login"),r().createElement(R.b,null,r().createElement(O.g,null,r().createElement(x.ks,{id:"login",onChange:(e,t)=>{m({...u,username:t})},value:u.username})))),r().createElement(L.Z,null,r().createElement(j.a,null,"Permissions"),r().createElement(R.b,null,r().createElement(O.g,null,r().createElement(C.S,{label:"Manage Support Cases",isChecked:d.portal_manage_cases,onChange:()=>{p("portal_manage_cases")},id:"controlled-check-1",name:"check1"}),r().createElement(C.S,{label:"Download Software and Updates",isChecked:d.portal_download,onChange:()=>{p("portal_download")},id:"controlled-check-2",name:"check2"}),r().createElement(C.S,{label:"View/Renew Subscription Information",isChecked:d.portal_system_management,onChange:()=>{p("portal_system_management")},id:"controlled-check-3",name:"check3"}),r().createElement(C.S,{label:"Manage Your Subscriptions",isChecked:d.portal_manage_subscriptions,onChange:()=>{p("portal_manage_subscriptions")},id:"controlled-check-4",name:"check4"}),r().createElement(c.c,{id:"adminDivider",component:"div"}),r().createElement(C.S,{label:"Account Administrator",isChecked:d.admin,onChange:()=>{p("admin")},id:"admin",name:"check5"})))),r().createElement(M.K,null,r().createElement(f.$n,{onClick:()=>{console.log("submitting formData object: "),console.log(u);const e={...u};let n;o&&(delete e.id,delete e.username,delete e.status),n=o?a.accountAPI+"/"+a.accountID+"/users/"+u.id:a.accountAPI+"/"+a.accountID+"/users",fetch(n,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.userToken},body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{e.status?400===e.status?(s([r().createElement(P.F,{title:e.title,key:e.title,variant:"danger",timeout:8e3},JSON.stringify(e.errors))]),document.getElementsByClassName("pf-c-page__main")[0].scrollTop=0):200===e.status?t():(s([r().createElement(P.F,{key:"mainAlert",title:e.title,variant:"danger",timeout:8e3},"Unexpected Result")]),document.getElementsByClassName("pf-c-page__main")[0].scrollTop=0):e.body&&t()}))},variant:"primary"},"Submit"),r().createElement(f.$n,{onClick:()=>{t()},variant:"link"},"Cancel"))))};B.propTypes={editingUser:v().bool,triggerReturn:v().func};const F=B;var Z=a(20881);const G=(0,n.createContext)({accountAPI:"",accountID:"",userToken:""}),$=()=>{const e=(0,Z.A)();let t;t="stage.foo.redhat.com:1337"===window.location.host||"console.stage.redhat.com"===window.location.host?"https://api.access.stage.redhat.com/account/v1/accounts":"https://api.access.redhat.com/account/v1/accounts";const[a,i]=(0,n.useState)({accountAPI:t,accountID:"",userToken:""}),u={accountAPI:t,accountID:"",userToken:""},[m,d]=(0,n.useState)({userList:!0,addUser:!1,editUser:!1}),[g,E]=(0,n.useState)(),h=()=>{d({userList:!1,addUser:!0,editUser:!1})},p=()=>{d({userList:!0,addUser:!1,editUser:!1})},b=e=>{E(e),d({userList:!1,addUser:!1,editUser:!0})};return(0,n.useEffect)((()=>{e.auth.getToken().then((e=>{u.userToken=String(e),fetch(a.accountAPI,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e}}).then((e=>e.json())).then((e=>{const t=e.body[0];u.accountID=t.id,i(u)}))}))}),[]),r().createElement("div",null,r().createElement(l.A,null,r().createElement(s.A,{title:"User Management",className:"pf-u-mb-lg"}),r().createElement("p",null," Manage organization users and privelages")),r().createElement(c.c,null),r().createElement(o.d8,null,r().createElement(G.Provider,{value:a},r().createElement((()=>a.accountID&&a.accountID.length>0?m.userList?r().createElement(A,{triggerAddUser:h,triggerEditUser:b,triggerCancel:p}):m.addUser?r().createElement(F,{triggerReturn:p,editingUser:void 0}):m.editUser?r().createElement(F,{triggerReturn:p,editingUser:g}):null:r().createElement("div",null,"Loading Spinner...")),null))))};var J=a(41404),V=a(14082),X=a(88095);const H=()=>{const e=(0,Z.A)();let t=null;const[a,l]=(0,n.useState)({adminUser:!0,renderedPage:r().createElement($,null)}),s=(0,X.useFlag)("iamconsole.usermanagement.enabled");return(0,n.useEffect)((()=>{e.auth.getToken().then((e=>{t=e,(0,J.X2)(t)&&s&&l({adminUser:!0,renderedPage:r().createElement($,null)}),s||l({adminUser:!1,renderedPage:r().createElement(V.A,null)})}))}),[]),r().createElement(r().Fragment,null,a.renderedPage)}},66403:()=>{},1537:()=>{},74895:()=>{},63701:()=>{},89092:()=>{},71036:()=>{},50545:()=>{},98497:()=>{},5937:()=>{},5637:()=>{},14332:()=>{},56083:()=>{},18340:()=>{},22405:()=>{},28195:()=>{},81117:()=>{},36752:()=>{}}]);
//# sourceMappingURL=../sourcemaps/User-Management.36c92709a67d8923691384d806a9aeb2.js.map